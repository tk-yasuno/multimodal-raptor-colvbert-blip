"""
災害ドメイン語彙辞書
津波教訓データベースに特化したドメイン語彙と除外語彙を管理
"""

# 災害ドメイン語彙（優先的に表示する語）
DISASTER_DOMAIN_KEYWORDS = {
    # 災害種別
    '津波', '地震', '台風', '豪雨', '洪水', '土砂', '火山', '噴火',
    '地滑り', '崩壊', '浸水', '氾濫', '高潮', '竜巻',
    
    # 避難・対応
    '避難', '避難所', '避難場所', '避難者', '避難指示', '避難勧告',
    '避難経路', '避難訓練', '避難行動', '避難計画', '避難誘導',
    '救助', '救援', '救護', '救出', '捜索', '救命',
    
    # 警報・情報
    '警報', '注意報', '緊急', '速報', '情報', 'アラート',
    '発令', '解除', '伝達', '通知', '周知', '広報',
    
    # 組織・機関
    '自治体', '市町村', '都道府県', '国', '政府', '気象庁',
    '消防', '警察', '自衛隊', '海上保安庁', '防災',
    '本部', '対策本部', '災害対策', '危機管理',
    
    # 被害・状況
    '被害', '被災', '被災者', '被災地', '死者', '行方不明',
    '負傷', '倒壊', '損壊', '浸水', '冠水', '孤立',
    '停電', '断水', '道路', '通行止め', '寸断',
    
    # 施設
    '学校', '病院', '公民館', '体育館', 'ホール', '施設',
    '港', '漁港', '堤防', 'ダム', '河川', '海岸',
    
    # 住民・地域
    '住民', '市民', '町民', '村民', '地域', '地区', '町内',
    '世帯', '家族', '子供', '高齢者', '要配慮者',
    
    # 対策・計画
    '対策', '計画', 'マニュアル', 'ガイドライン', '訓練',
    '想定', 'シミュレーション', 'ハザードマップ',
    
    # 時間・フェーズ
    '発生', '直後', '当日', '翌日', '数日後', '復旧', '復興',
    
    # 固有名詞（重要な地名・イベント）
    '東日本', '阪神', '熊本', '北海道', '九州', '四国',
    '太平洋', '日本海', '南海トラフ', '東海',
}

# 除外する一般語（形態素解析でノイズとなる語）
STOP_WORDS = {
    # 代名詞・指示語
    'こと', 'もの', 'ため', 'よう', 'ところ', 'これ', 'それ', 'あれ',
    'この', 'その', 'あの', 'どの', 'ここ', 'そこ', 'あそこ', 'どこ',
    'こちら', 'そちら', 'あちら', 'どちら',
    
    # 助詞的な名詞
    'について', 'における', 'に関する', 'による', 'によって',
    'として', 'とする', 'に対する', 'に対して', 'において',
    'によると', 'に関して', 'に際して', 'に伴う', 'に伴って',
    
    # 形式名詞
    'である', 'です', 'ます', 'した', 'する', 'なる', 'いる',
    'ある', 'できる', 'られる', 'される', 'いう', 'いった',
    
    # 抽象的な名詞
    'など', 'ほか', '以上', '以下', '以外', '程度', '場合', '状態',
    '状況', '内容', '結果', '影響', '効果', '必要', '可能',
    '重要', '主要', '全体', '一部', '多く', 'さまざま', '様々',
    
    # 時間表現（一般的すぎるもの）
    '時', '時間', '分', '秒', '日', '月', '年', '期間',
    '当時', '現在', '今後', '以降', '以前', 'まで',
    
    # 数量表現
    '人', '名', '件', '回', '度', '箇所', '地点', '箇所',
    
    # 接続詞的
    'また', 'さらに', 'そして', 'しかし', 'ただし', 'なお',
    'ただ', 'もっとも', 'すなわち', 'つまり', 'ちなみに',
    
    # LLM出力の警告メッセージ・定型句
    'はじめに', 'はじめ', '申し訳ございません', '提示', '申し訳',
    
    # その他
    '実施', '確認', '報告', '記録', '資料', '参考', '事例',
    '例', 'ケース', 'データ', '情報', '詳細', '概要',
}

# 数字のみの語（正規表現パターン）
NUMERIC_PATTERN = r'^\d+$|^[０-９]+$'

def is_disaster_keyword(word: str) -> bool:
    """語が災害ドメインキーワードかどうか判定"""
    return word in DISASTER_DOMAIN_KEYWORDS

def is_stop_word(word: str) -> bool:
    """語がストップワードかどうか判定"""
    import re
    if word in STOP_WORDS:
        return True
    # 数字のみもストップワード扱い
    if re.match(NUMERIC_PATTERN, word):
        return True
    return False

def filter_keywords(words: list[str], prioritize_domain: bool = True) -> list[str]:
    """
    キーワードリストをフィルタリング
    
    Args:
        words: 元のキーワードリスト
        prioritize_domain: ドメイン語彙を優先するか
    
    Returns:
        フィルタリングされたキーワードリスト
    """
    # ストップワード除外
    filtered = [w for w in words if not is_stop_word(w)]
    
    if prioritize_domain:
        # ドメイン語彙を優先
        domain_words = [w for w in filtered if is_disaster_keyword(w)]
        other_words = [w for w in filtered if not is_disaster_keyword(w)]
        return domain_words + other_words
    
    return filtered
